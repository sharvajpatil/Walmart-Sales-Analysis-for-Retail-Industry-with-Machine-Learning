<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walmart Sales Prediction</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>
    <div class="container">
        <h1 class="text-center my-4">Walmart Sales Prediction</h1>
        <form id="predictionForm">
            <div class="form-group">
                <label for="store">Store:</label>
                <input type="text" id="store" name="store" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="size">Size:</label>
                <input type="text" id="size" name="size" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="dept">Department:</label>
                <input type="text" id="dept" name="dept" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="temperature">Temperature:</label>
                <input type="text" id="temperature" name="temp" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="date">Date:</label>
                <input type="date" id="date" name="date" class="form-control" required>
            </div>
            <div class="form-group">
                <label>IsHoliday:</label>
                <div class="radio-group">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" id="isHoliday-yes" name="isHolidayRadio" value="1">
                        <label class="form-check-label" for="isHoliday-yes">Yes</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" id="isHoliday-no" name="isHolidayRadio" value="0" checked>
                        <label class="form-check-label" for="isHoliday-no">No</label>
                    </div>
                </div>
            </div>
            <button type="button" class="btn btn-primary" onclick="predictSales()">Predict</button>
        </form>
    </div>
    <div class="popup" id="popup">
        <p id="popupContent"></p>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script>
    function showLoadingOverlay() {
        document.getElementById("loadingOverlay").style.display = "flex";
    }

    function hideLoadingOverlay() {
        document.getElementById("loadingOverlay").style.display = "none";
    }

    setTimeout(function() {
        hideLoadingOverlay();
    }, 3000);

    function predictSales() {
        showLoadingOverlay();
        setTimeout(function() {
            var formData = new FormData(document.getElementById("predictionForm"));
            fetch("/predict", {
                method: "POST",
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                hideLoadingOverlay();
                var output = data.output;
                var store = data.store;
                var dept = data.dept;
                var month_name = data.month_name;
                var year = data.year;
                var popupMsg = "Predicted weekly sales for Store " + store + ", Department " + dept + " in the month of " + month_name + " " + year + " is: $" + output;
                alert(popupMsg);
            })
            .catch(error => {
                hideLoadingOverlay();
                console.error('Error:', error);
            });
        }, 3000);
    }
</script>
</body>
</html>
